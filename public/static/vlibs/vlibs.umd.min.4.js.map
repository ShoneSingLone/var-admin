{"version":3,"sources":["webpack://vlibs/./public/static/bundle/PageLayoutEditor/index.vue?c82f","webpack://vlibs/./public/static/bundle/PageLayoutEditor/Monaco.vue?d6cb","webpack://vlibs/public/static/bundle/PageLayoutEditor/Monaco.vue","webpack://vlibs/./public/static/bundle/PageLayoutEditor/Monaco.vue?57a7","webpack://vlibs/./public/static/bundle/PageLayoutEditor/Monaco.vue","webpack://vlibs/public/static/bundle/PageLayoutEditor/index.vue","webpack://vlibs/./public/static/bundle/PageLayoutEditor/index.vue?7695","webpack://vlibs/./public/static/bundle/PageLayoutEditor/index.vue","webpack://vlibs/./public/static/bundle/PageLayoutEditor/index.vue?2b36"],"names":["render","_vm","this","_h","$createElement","_c","_self","staticClass","_l","item","key","class","getUsedTimes","attrs","_v","_s","label","directives","name","rawName","value","expression","val","prop","model","tableConfigs","callback","$$v","$set","rowItem","rowIndex","on","$event","removeRow","colItem","colIndex","p","c","r","handleDrop","itemInfo","handleClickItem","addCol","removeCol","addRow","dsl","handleItemInfoChange","itemDsl","handleItemChange","staticRenderFns","ref","staticStyle","event","props","monacoInstance","init","$watch","map","$emit","setValue","isFormat","JSON","stringify","error","console","log","immediate","methods","create","$refs","container","language","automaticLayout","theme","minimap","enabled","addCommand","CtrlCmd","KEY_S","fnGetVal","Function","getValue","h","$message","message","style","component","use","components","Monaco","col","row","currentrc","targetText","computed","i","count","flattendsl","push","_list","splice","length","toItem","fromItem","fromValue","toValue","dslArray","colCount","itemProp","pop","currentEditItemInfo","info"],"mappings":"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","file":"vlibs.umd.min.4.js","sourcesContent":["var render = function () {var _vm=this;var _h=_vm.$createElement;var _c=_vm._self._c||_h;return _c('div',{staticClass:\"layouter\"},[_c('ul',{staticClass:\"item-list panel\"},_vm._l((_vm.itemInfo),function(item,key){return _c('drag',{key:key,class:['item-wrapper',{'notice-unuse':_vm.getUsedTimes(item)<1}],attrs:{\"tag\":\"li\",\"transfer-data\":item}},[_vm._v(\" \"+_vm._s(item.label)+\" \"),_c('span',{directives:[{name:\"show\",rawName:\"v-show\",value:(_vm.getUsedTimes(item)>1),expression:\"getUsedTimes(item)>1\"}],staticClass:\"use-many-times\"},[_vm._v(\"use \"+_vm._s(_vm.getUsedTimes(item))+\" times\")])])}),1),_c('div',{staticClass:\"table\"},[_c('div',{staticClass:\"panel table-options\"},_vm._l((_vm.tableConfigs),function(val,prop){return _c('div',{key:prop,staticClass:\"config\"},[_c('span',[_vm._v(_vm._s(prop)+\":\")]),_c('el-input',{model:{value:(_vm.tableConfigs[prop]),callback:function ($$v) {_vm.$set(_vm.tableConfigs, prop, $$v)},expression:\"tableConfigs[prop]\"}})],1)}),0),_c('table',{staticClass:\"table-stage panel\"},[_vm._l((_vm.dsl),function(rowItem,rowIndex){return _c('tr',{key:rowIndex},[_c('td',{staticClass:\"remove-row\"},[_c('el-button',{on:{\"click\":function($event){return _vm.removeRow(rowIndex)}}},[_vm._v(\" -Row \")])],1),_vm._l((rowItem),function(colItem,colIndex){return _c('drop',{key:colItem.p||'empty'+colIndex,staticClass:\"td-item\",attrs:{\"tag\":\"td\",\"colspan\":colItem.c||1,\"rowspan\":colItem.r||1},on:{\"drop\":function($event){return _vm.handleDrop({ rowIndex: rowIndex,colIndex: colIndex},$event)}}},[_c('drag',{staticClass:\"item-wrapper\",attrs:{\"tag\":\"div\",\"transfer-data\":{ rowIndex: rowIndex,colIndex: colIndex}}},[_c('span',{staticClass:\"label\"},[_vm._v(_vm._s(_vm.itemInfo[colItem.p]&&_vm.itemInfo[colItem.p].label))]),_c('i',{staticClass:\"el-icon-edit icon\",on:{\"click\":function($event){return _vm.handleClickItem(colItem,{r:rowIndex,c:colIndex})}}})])],1)}),_c('td',{staticClass:\"add-col\"},[_c('el-button',{on:{\"click\":function($event){return _vm.addCol(rowItem)}}},[_vm._v(\" +Col \")]),_c('el-button',{on:{\"click\":function($event){return _vm.removeCol(rowItem)}}},[_vm._v(\" -Col \")])],1)],2)}),_c('tr',[_c('td',{staticClass:\"add-row\"},[_c('el-button',{on:{\"click\":_vm.addRow}},[_vm._v(\" +Row \")])],1)])],2)]),_c('div',{staticClass:\"json-panel\"},[_c('div',{staticClass:\"json-panel-item panel layout\"},[_c('h6',[_vm._v(\"布局\")]),_c('monaco',{model:{value:(_vm.dsl),callback:function ($$v) {_vm.dsl=$$v},expression:\"dsl\"}})],1),_c('div',{staticClass:\"json-panel-item panel item-info\"},[_c('h6',[_vm._v(\"所有item信息\")]),_c('monaco',{attrs:{\"is-format\":\"true\"},on:{\"change\":_vm.handleItemInfoChange},model:{value:(_vm.itemInfo),callback:function ($$v) {_vm.itemInfo=$$v},expression:\"itemInfo\"}})],1),_c('div',{staticClass:\"json-panel-item panel col-item\"},[_c('h6',[_vm._v(\"单个item布局信息修改\")]),_c('monaco',{attrs:{\"value\":_vm.itemDsl,\"is-format\":\"true\"},on:{\"change\":_vm.handleItemChange}})],1)])])}\nvar staticRenderFns = []\n\nexport { render, staticRenderFns }","var render = function () {var _vm=this;var _h=_vm.$createElement;var _c=_vm._self._c||_h;return _c('div',{ref:\"container\",staticStyle:{\"height\":\"100%\"}})}\nvar staticRenderFns = []\n\nexport { render, staticRenderFns }","<template>\r\n  <div\r\n    ref=\"container\"\r\n    style=\"height:100%;\"\r\n  />\r\n</template>\r\n<script>\r\nimport * as monaco from \"monaco-editor/esm/vs/editor/editor.api.js\";\r\nimport isString from \"lodash/isString\";\r\nimport isArray from \"lodash/isArray\";\r\n\r\nexport default {\r\n  name: \"Monaco\",\r\n  model: {\r\n    prop: \"value\",\r\n    event: \"change\",\r\n  },\r\n  props: [\"value\", \"isFormat\"],\r\n  data() {\r\n    return {\r\n      monacoInstance: false,\r\n    };\r\n  },\r\n  mounted() {\r\n    this.init();\r\n    this.$watch(\r\n      \"value\",\r\n      (val) => {\r\n        try {\r\n          if (isArray(val) && isString(val[0])) {\r\n            val = val.map((p) => [{ p }]);\r\n            this.$emit(\"change\", val);\r\n          }\r\n          this.monacoInstance &&\r\n            this.monacoInstance.setValue(\r\n              this.isFormat ? JSON.stringify(val, null, 2) : JSON.stringify(val)\r\n            );\r\n        } catch (error) {\r\n          console.log(error);\r\n        }\r\n      },\r\n      { immediate: true }\r\n    );\r\n  },\r\n  methods: {\r\n    setValue(model) {\r\n      this.monacoInstance &&\r\n        this.monacoInstance.setValue(JSON.stringify(model));\r\n    },\r\n    async init() {\r\n      try {\r\n        //创建编辑器\r\n        this.monacoInstance = monaco.editor.create(this.$refs.container, {\r\n          //内容\r\n          // value: 'console.log(\"Hello world!\");',\r\n          //语言\r\n          language: \"javascript\",\r\n          //自适应调整\r\n          automaticLayout: true,\r\n          //主题，三款：vs、vs-dark、hc-black\r\n          theme: \"vs-dark\",\r\n          //代码略缩图\r\n          minimap: {\r\n            enabled: true,\r\n          },\r\n        });\r\n        //内容改变事件\r\n        /*       this.monacoInstance.onDidChangeModelContent(e => { });\r\n         */\r\n        //添加按键监听\r\n        this.monacoInstance.addCommand(\r\n          monaco.KeyMod.CtrlCmd | monaco.KeyCode.KEY_S,\r\n          () => {\r\n            try {\r\n              const fnGetVal = new Function(\r\n                `return ${this.monacoInstance.getValue()}`\r\n              );\r\n              this.$emit(\"change\", fnGetVal());\r\n            } catch (error) {\r\n              console.error(error);\r\n              this.setValue(this.value);\r\n              const h = this.$createElement;\r\n              this.$message({\r\n                message: h(\"p\", null, [\r\n                  h(\"span\", null, \"JSON 有问题，不转换\"),\r\n                  h(\"i\", { style: \"color: teal\" }),\r\n                ]),\r\n              });\r\n            }\r\n          }\r\n        );\r\n      } catch (error) {\r\n        console.error(error);\r\n      }\r\n    },\r\n  },\r\n};\r\n</script>\r\n<style lang=\"scss\">\r\n</style>","import mod from \"-!../../../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./Monaco.vue?vue&type=script&lang=js&\"; export default mod; export * from \"-!../../../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./Monaco.vue?vue&type=script&lang=js&\"","import { render, staticRenderFns } from \"./Monaco.vue?vue&type=template&id=41ee24ec&\"\nimport script from \"./Monaco.vue?vue&type=script&lang=js&\"\nexport * from \"./Monaco.vue?vue&type=script&lang=js&\"\n\n\n/* normalize component */\nimport normalizer from \"!../../../../node_modules/vue-loader/lib/runtime/componentNormalizer.js\"\nvar component = normalizer(\n  script,\n  render,\n  staticRenderFns,\n  false,\n  null,\n  null,\n  null\n  \n)\n\nexport default component.exports","<template>\r\n  <div class=\"layouter\">\r\n    <!--  -->\r\n    <ul class=\"item-list panel\">\r\n      <drag\r\n        v-for=\"(item,key) in itemInfo\"\r\n        :key=\"key\"\r\n        :class=\"['item-wrapper',{'notice-unuse':getUsedTimes(item)<1}]\"\r\n        tag=\"li\"\r\n        :transfer-data=\"item\"\r\n      >\r\n        {{ item.label }}\r\n        <span\r\n          v-show=\"getUsedTimes(item)>1\"\r\n          class=\"use-many-times\"\r\n        >use {{ getUsedTimes(item) }} times</span>\r\n      </drag>\r\n    </ul>\r\n    <!-- 【】 -->\r\n    <div class=\"table\">\r\n      <div class=\"panel table-options\">\r\n        <div\r\n          v-for=\"(val,prop) in tableConfigs\"\r\n          :key=\"prop\"\r\n          class=\"config\"\r\n        >\r\n          <span>{{ prop }}:</span>\r\n          <el-input v-model=\"tableConfigs[prop]\" />\r\n        </div>\r\n      </div>\r\n\r\n      <table class=\"table-stage panel\">\r\n        <tr\r\n          v-for=\"(rowItem, rowIndex) in dsl\"\r\n          :key=\"rowIndex\"\r\n        >\r\n          <td class=\"remove-row\">\r\n            <el-button @click=\"removeRow(rowIndex)\">\r\n              -Row\r\n            </el-button>\r\n          </td>\r\n          <drop\r\n            v-for=\"(colItem,colIndex) in rowItem\"\r\n            :key=\"colItem.p||'empty'+colIndex\"\r\n            tag=\"td\"\r\n            :colspan=\"colItem.c||1\"\r\n            :rowspan=\"colItem.r||1\"\r\n            class=\"td-item\"\r\n            @drop=\"handleDrop({ rowIndex,colIndex},$event)\"\r\n          >\r\n            <drag\r\n              class=\"item-wrapper\"\r\n              tag=\"div\"\r\n              :transfer-data=\"{ rowIndex,colIndex}\"\r\n            >\r\n              <span class=\"label\">{{ itemInfo[colItem.p]&&itemInfo[colItem.p].label }}</span>\r\n              <i\r\n                class=\"el-icon-edit icon\"\r\n                @click=\"handleClickItem(colItem,{r:rowIndex,c:colIndex})\"\r\n              />\r\n            </drag>\r\n          </drop>\r\n          <td class=\"add-col\">\r\n            <el-button @click=\"addCol(rowItem)\">\r\n              +Col\r\n            </el-button>\r\n            <el-button @click=\"removeCol(rowItem)\">\r\n              -Col\r\n            </el-button>\r\n          </td>\r\n        </tr>\r\n        <tr>\r\n          <td class=\"add-row\">\r\n            <el-button @click=\"addRow\">\r\n              +Row\r\n            </el-button>\r\n          </td>\r\n        </tr>\r\n      </table>\r\n    </div>\r\n    <div class=\"json-panel\">\r\n      <div class=\"json-panel-item panel layout\">\r\n        <h6>布局</h6>\r\n        <monaco v-model=\"dsl\" />\r\n      </div>\r\n      <!-- item的信息，比如label -->\r\n      <div class=\"json-panel-item panel item-info\">\r\n        <h6>所有item信息</h6>\r\n        <monaco\r\n          v-model=\"itemInfo\"\r\n          is-format=\"true\"\r\n          @change=\"handleItemInfoChange\"\r\n        />\r\n      </div>\r\n      <div class=\"json-panel-item panel col-item\">\r\n        <h6>单个item布局信息修改</h6>\r\n        <monaco\r\n          :value=\"itemDsl\"\r\n          is-format=\"true\"\r\n          @change=\"handleItemChange\"\r\n        />\r\n      </div>\r\n    </div>\r\n  </div>\r\n</template>\r\n<script>\r\nimport Monaco from \"./Monaco\";\r\nimport cloneDeep from \"lodash/cloneDeep\";\r\nimport has from \"lodash/has\";\r\nimport map from \"lodash/map\";\r\nimport flattenDeep from \"lodash/flattenDeep\";\r\nimport each from \"lodash/each\";\r\nimport VueDragDrop from \"vue-drag-drop\";\r\nimport Vue from \"vue\";\r\nVue.use(VueDragDrop);\r\n\r\n\r\nexport default {\r\n  name: \"Layouter\",\r\n  components: { Monaco },\r\n  data() {\r\n    return {\r\n      tableConfigs: {\r\n        col: 3,\r\n        row: 1,\r\n      },\r\n      itemInfo: {},\r\n      currentrc: \"\",\r\n      dsl: [[{ p: \"\" }, { p: \"\" }, { p: \"\" }]],\r\n      itemDsl: {},\r\n      targetText: \"target source\",\r\n    };\r\n  },\r\n  computed: {\r\n    flattendsl() {\r\n      return flattenDeep(this.dsl).map((i) => i.p);\r\n    },\r\n  },\r\n  methods: {\r\n    getUsedTimes(item) {\r\n      let count = 0;\r\n      each(this.flattendsl, (prop) => {\r\n        if (item.prop === prop) count++;\r\n      });\r\n      return count;\r\n    },\r\n    addCol(row) {\r\n      row.push({ p: \"\" });\r\n      const _list = cloneDeep(this.dsl);\r\n      this.dsl = _list;\r\n    },\r\n    removeCol(row) {\r\n      row.splice(row.length - 1);\r\n      const _list = cloneDeep(this.dsl);\r\n      this.dsl = _list;\r\n    },\r\n    addRow() {\r\n      this.dsl.push(\r\n        (this.dsl[0] && this.dsl[0].map(() => ({ p: \"\" }))) || [{ p: \"\" }]\r\n      );\r\n    },\r\n    removeRow(rowIndex) {\r\n      this.dsl.splice(rowIndex, 1);\r\n    },\r\n    handleDrop(toItem, fromItem /* transfer-data */) {\r\n      const _list = cloneDeep(this.dsl);\r\n      let fromValue, toValue;\r\n      if (has(fromItem, \"label\")) {\r\n        /* 从列表选取，不交换 */\r\n        fromValue = {\r\n          p: fromItem.prop,\r\n        };\r\n      } else {\r\n        /* 交换 */\r\n        toValue = this.dsl[toItem.rowIndex][toItem.colIndex];\r\n        fromValue = this.dsl[fromItem.rowIndex][fromItem.colIndex];\r\n        _list[fromItem.rowIndex][fromItem.colIndex] = toValue;\r\n      }\r\n      _list[toItem.rowIndex][toItem.colIndex] = fromValue;\r\n      this.dsl = _list;\r\n    },\r\n    handleItemInfoChange(itemInfo) {\r\n      this.itemInfo = itemInfo;\r\n      const dslArray = map(itemInfo, (item) => item.prop);\r\n      const dsl = [];\r\n      let row = [];\r\n      let colCount = 0;\r\n\r\n      while (dslArray.length > 0) {\r\n        let itemProp = dslArray.pop();\r\n        row.push({ p: itemProp });\r\n        /* 该换行了 */\r\n        if (++colCount >= this.tableConfigs.col) {\r\n          dsl.push(row);\r\n          row = [];\r\n          colCount = 0;\r\n        }\r\n      }\r\n      /* 最后一次没有在循环体中完成的push */\r\n      if (colCount < this.tableConfigs.col) {\r\n        dsl.push(row);\r\n      }\r\n      this.dsl = dsl;\r\n    },\r\n    handleItemChange(item) {\r\n      this.itemDsl = item;\r\n      const { r, c } = this.currentEditItemInfo;\r\n      this.dsl[r][c] = item;\r\n      const _list = cloneDeep(this.dsl);\r\n      this.dsl = _list;\r\n    },\r\n    handleClickItem(item, info) {\r\n      this.itemDsl = item;\r\n      this.currentrc = `r${info.rowIndex}c${info.colIndex}`;\r\n      this.currentEditItemInfo = info;\r\n    },\r\n  },\r\n};\r\n</script>\r\n<style lang=\"less\" scoped>\r\n.layouter {\r\n  height: 100vh;\r\n  width: 100%;\r\n  overflow: hidden;\r\n  display: flex;\r\n  flex-flow: row nowrap;\r\n  justify-content: center;\r\n  align-items: center;\r\n\r\n  .panel {\r\n    border: 2px solid #303030;\r\n    border-radius: 8px;\r\n    margin: 10px;\r\n  }\r\n  .item-list {\r\n    width: 10%;\r\n    height: 100%;\r\n    overflow: auto;\r\n    margin: 10px;\r\n    padding: 0;\r\n    > li {\r\n      &.notice-unuse {\r\n        border-radius: 4px;\r\n        border: 1px solid red;\r\n        color: red;\r\n      }\r\n      span.use-many-times {\r\n        color: orange;\r\n        border-radius: 4px;\r\n        border: 1px solid red;\r\n        padding: 2px;\r\n        background: black;\r\n      }\r\n      margin: 10px;\r\n      list-style: none;\r\n      padding: 4px;\r\n    }\r\n  }\r\n  .table {\r\n    width: 55%;\r\n    height: 100vh;\r\n    float: left;\r\n    display: flex;\r\n    flex-flow: column nowrap;\r\n    justify-content: flex-start;\r\n    overflow: auto;\r\n    .table-options {\r\n      .config {\r\n        display: flex;\r\n        flex-flow: row nowrap;\r\n        justify-content: center;\r\n        align-items: center;\r\n        padding: 10px;\r\n        span {\r\n          margin: 0 1rem;\r\n        }\r\n      }\r\n    }\r\n    .table-stage {\r\n      flex: 1;\r\n      tr {\r\n        &:hover {\r\n          background: #f0f9eb;\r\n        }\r\n      }\r\n    }\r\n    .td-item {\r\n      width: 160px;\r\n      font-size: 1rem;\r\n      text-align: center;\r\n      border: 1px solid #303030;\r\n\r\n      .item-wrapper {\r\n        display: flex;\r\n        flex-flow: row nowrap;\r\n        justify-content: space-between;\r\n        align-items: center;\r\n      }\r\n    }\r\n  }\r\n  .json-panel {\r\n    text-align:left;\r\n    width: 35%;\r\n    height: 100%;\r\n    float: right;\r\n    display: flex;\r\n    flex-flow: column nowrap;\r\n    justify-content: space-between;\r\n    h6 {\r\n      padding: 0;\r\n      margin: 10px;\r\n    }\r\n    .json-panel-item {\r\n      height: 50%;\r\n      margin: 10px;\r\n      padding: 10px;\r\n      display: flex;\r\n      flex-flow: column nowrap;\r\n      &.layout {\r\n        height: 20%;\r\n      }\r\n      &.item-info {\r\n        height: 30%;\r\n      }\r\n\r\n      overflow: auto;\r\n    }\r\n    .textarea-panel {\r\n      height: 100%;\r\n      width: 100%;\r\n    }\r\n  }\r\n}\r\n</style>","import mod from \"-!../../../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./index.vue?vue&type=script&lang=js&\"; export default mod; export * from \"-!../../../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./index.vue?vue&type=script&lang=js&\"","import { render, staticRenderFns } from \"./index.vue?vue&type=template&id=295ebb5d&scoped=true&\"\nimport script from \"./index.vue?vue&type=script&lang=js&\"\nexport * from \"./index.vue?vue&type=script&lang=js&\"\nimport style0 from \"./index.vue?vue&type=style&index=0&id=295ebb5d&lang=less&scoped=true&\"\n\n\n/* normalize component */\nimport normalizer from \"!../../../../node_modules/vue-loader/lib/runtime/componentNormalizer.js\"\nvar component = normalizer(\n  script,\n  render,\n  staticRenderFns,\n  false,\n  null,\n  \"295ebb5d\",\n  null\n  \n)\n\nexport default component.exports","import mod from \"-!../../../../node_modules/mini-css-extract-plugin/dist/loader.js??ref--10-oneOf-1-0!../../../../node_modules/@vue/cli-service/node_modules/css-loader/dist/cjs.js??ref--10-oneOf-1-1!../../../../node_modules/vue-loader/lib/loaders/stylePostLoader.js!../../../../node_modules/postcss-loader/src/index.js??ref--10-oneOf-1-2!../../../../node_modules/less-loader/dist/cjs.js??ref--10-oneOf-1-3!../../../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./index.vue?vue&type=style&index=0&id=295ebb5d&lang=less&scoped=true&\"; export default mod; export * from \"-!../../../../node_modules/mini-css-extract-plugin/dist/loader.js??ref--10-oneOf-1-0!../../../../node_modules/@vue/cli-service/node_modules/css-loader/dist/cjs.js??ref--10-oneOf-1-1!../../../../node_modules/vue-loader/lib/loaders/stylePostLoader.js!../../../../node_modules/postcss-loader/src/index.js??ref--10-oneOf-1-2!../../../../node_modules/less-loader/dist/cjs.js??ref--10-oneOf-1-3!../../../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./index.vue?vue&type=style&index=0&id=295ebb5d&lang=less&scoped=true&\""],"sourceRoot":""}